# å°ç¨‹åºAPIåœ°å€é…ç½®ä¿®å¤æŒ‡å—

## ğŸš¨ é—®é¢˜æè¿°

ç”¨æˆ·è¯¢é—®å¾®ä¿¡å°ç¨‹åºè°ƒç”¨APIçš„åœ°å€æ˜¯å¦å·²ç»æ”¹æˆäº† `http://223.93.139.87:3002`ã€‚

## ğŸ” æ£€æŸ¥ç»“æœ

### é…ç½®æ–‡ä»¶çŠ¶æ€
âœ… **ç”Ÿäº§ç¯å¢ƒé…ç½®æ­£ç¡®**
- æ–‡ä»¶: `miniprogram/config/production.js`
- é…ç½®: `BASE_URL: 'http://223.93.139.87:3002'`

âœ… **å¼€å‘ç¯å¢ƒé…ç½®æ­£ç¡®**
- æ–‡ä»¶: `miniprogram/config/development.js`
- é…ç½®: `BASE_URL: 'http://localhost:3002'`

### å‘ç°çš„é—®é¢˜
âŒ **ç¡¬ç¼–ç åœ°å€é—®é¢˜**
- æ–‡ä»¶: `miniprogram/pages/answer/index.js`
- é—®é¢˜: å›¾ç‰‡è·¯å¾„å¤„ç†ä¸­ç¡¬ç¼–ç äº† `localhost:3002`
- å½±å“: ç”Ÿäº§ç¯å¢ƒä¸­å›¾ç‰‡æ— æ³•æ­£ç¡®åŠ è½½

## ğŸ”§ ä¿®å¤å†…å®¹

### 1. ä¿®å¤å›¾ç‰‡è·¯å¾„ç¡¬ç¼–ç é—®é¢˜

#### ä¿®å¤å‰
```javascript
// pages/answer/index.js
path: `http://localhost:3002/uploads${image.path}`,
path: `http://localhost:3002/uploads/${image.path}`,
path: `http://localhost:3002/uploads/images/${image.path}`,
```

#### ä¿®å¤å
```javascript
// pages/answer/index.js
const config = require('../../config/production.js') // ç”Ÿäº§ç¯å¢ƒé…ç½®

path: `${config.BASE_URL}/uploads${image.path}`,
path: `${config.BASE_URL}/uploads/${image.path}`,
path: `${config.BASE_URL}/uploads/images/${image.path}`,
```

### 2. ä¿®å¤URLè·¯å¾„ä¿®æ­£é€»è¾‘

#### ä¿®å¤å‰
```javascript
else if (image.path && image.path.startsWith('http://localhost:3002/images/')) {
  const correctedPath = image.path.replace('http://localhost:3002/images/', 'http://localhost:3002/uploads/images/')
```

#### ä¿®å¤å
```javascript
else if (image.path && image.path.startsWith(`${config.BASE_URL}/images/`)) {
  const correctedPath = image.path.replace(`${config.BASE_URL}/images/`, `${config.BASE_URL}/uploads/images/`)
```

## ğŸ“‹ ä¿®å¤éªŒè¯

### æ£€æŸ¥ç»“æœ
âœ… **æ‰€æœ‰é…ç½®æ­£ç¡®**
- ç”Ÿäº§ç¯å¢ƒ: `http://223.93.139.87:3002`
- å¼€å‘ç¯å¢ƒ: `http://localhost:3002`
- æ‰€æœ‰APIè°ƒç”¨éƒ½ä½¿ç”¨é…ç½®æ–‡ä»¶
- å›¾ç‰‡è·¯å¾„å¤„ç†å·²ä¿®å¤

### éªŒè¯å‘½ä»¤
```bash
# è¿è¡Œé…ç½®æ£€æŸ¥è„šæœ¬
node check-miniprogram-api-config.js
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### ç¯å¢ƒåˆ‡æ¢
å°ç¨‹åºä¼šæ ¹æ®é…ç½®æ–‡ä»¶è‡ªåŠ¨ä½¿ç”¨æ­£ç¡®çš„APIåœ°å€ï¼š

#### ç”Ÿäº§ç¯å¢ƒ
```javascript
// miniprogram/utils/server-api.js
const config = require('../config/production.js') // ç”Ÿäº§ç¯å¢ƒ
```

#### å¼€å‘ç¯å¢ƒ
```javascript
// miniprogram/utils/server-api.js
// const config = require('../config/production.js') // ç”Ÿäº§ç¯å¢ƒ
const config = require('../config/development.js') // å¼€å‘ç¯å¢ƒ
```

### é…ç½®è¯´æ˜
- **ç”Ÿäº§ç¯å¢ƒ**: ä½¿ç”¨ `http://223.93.139.87:3002`
- **å¼€å‘ç¯å¢ƒ**: ä½¿ç”¨ `http://localhost:3002`
- **è‡ªåŠ¨åˆ‡æ¢**: é€šè¿‡æ³¨é‡Š/å–æ¶ˆæ³¨é‡Šé…ç½®è¡Œæ¥åˆ‡æ¢

## ğŸ” æŠ€æœ¯ç»†èŠ‚

### APIè°ƒç”¨æµç¨‹
```
å°ç¨‹åºé¡µé¢ â†’ server-api.js â†’ config/production.js â†’ http://223.93.139.87:3002
```

### å›¾ç‰‡è·¯å¾„å¤„ç†
```
ç›¸å¯¹è·¯å¾„ â†’ config.BASE_URL + è·¯å¾„ â†’ å®Œæ•´URL
```

### å…³é”®æ–‡ä»¶
- `miniprogram/config/production.js` - ç”Ÿäº§ç¯å¢ƒé…ç½®
- `miniprogram/config/development.js` - å¼€å‘ç¯å¢ƒé…ç½®
- `miniprogram/utils/server-api.js` - APIè°ƒç”¨å·¥å…·
- `miniprogram/pages/answer/index.js` - ç­”é¢˜é¡µé¢ï¼ˆå·²ä¿®å¤ï¼‰

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. ç¯å¢ƒç®¡ç†
- ä½¿ç”¨é…ç½®æ–‡ä»¶ç®¡ç†ä¸åŒç¯å¢ƒçš„APIåœ°å€
- é¿å…ç¡¬ç¼–ç åœ°å€
- é€šè¿‡æ³¨é‡Šåˆ‡æ¢ç¯å¢ƒ

### 2. è·¯å¾„å¤„ç†
- ä½¿ç”¨é…ç½®çš„BASE_URLæ„å»ºå®Œæ•´è·¯å¾„
- æ”¯æŒå¤šç§å›¾ç‰‡è·¯å¾„æ ¼å¼
- è‡ªåŠ¨ä¿®æ­£é”™è¯¯çš„è·¯å¾„

### 3. æµ‹è¯•éªŒè¯
- å®šæœŸæ£€æŸ¥é…ç½®æ˜¯å¦æ­£ç¡®
- éªŒè¯APIè°ƒç”¨æ˜¯å¦æ­£å¸¸
- æµ‹è¯•å›¾ç‰‡åŠ è½½æ˜¯å¦æ­£å¸¸

## ğŸ”„ ç»´æŠ¤å»ºè®®

### å®šæœŸæ£€æŸ¥
1. éªŒè¯APIåœ°å€é…ç½®
2. æ£€æŸ¥ç¡¬ç¼–ç åœ°å€
3. æµ‹è¯•å›¾ç‰‡åŠ è½½
4. éªŒè¯ç¯å¢ƒåˆ‡æ¢

### ç›‘æ§æŒ‡æ ‡
- APIè°ƒç”¨æˆåŠŸç‡
- å›¾ç‰‡åŠ è½½æˆåŠŸç‡
- å“åº”æ—¶é—´
- é”™è¯¯ç‡

## ğŸ“ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **APIè°ƒç”¨å¤±è´¥**
   - æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®
   - éªŒè¯æœåŠ¡å™¨åœ°å€æ˜¯å¦å¯è¾¾
   - ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸

2. **å›¾ç‰‡åŠ è½½å¤±è´¥**
   - æ£€æŸ¥å›¾ç‰‡è·¯å¾„æ˜¯å¦æ­£ç¡®
   - éªŒè¯æœåŠ¡å™¨å›¾ç‰‡æœåŠ¡æ˜¯å¦æ­£å¸¸
   - ç¡®è®¤BASE_URLé…ç½®æ­£ç¡®

3. **ç¯å¢ƒåˆ‡æ¢é—®é¢˜**
   - æ£€æŸ¥é…ç½®æ–‡ä»¶å¼•å…¥æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤æ³¨é‡ŠçŠ¶æ€æ­£ç¡®
   - éªŒè¯é…ç½®å†…å®¹æ˜¯å¦åŒ¹é…

### è°ƒè¯•å‘½ä»¤
```bash
# æ£€æŸ¥é…ç½®
node check-miniprogram-api-config.js

# æµ‹è¯•APIè¿æ¥
# åœ¨å°ç¨‹åºä¸­æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—
```

## âœ… ä¿®å¤ç¡®è®¤

ä¿®å¤å®Œæˆåï¼Œè¯·ç¡®è®¤ä»¥ä¸‹é¡¹ç›®ï¼š

- [x] ç”Ÿäº§ç¯å¢ƒé…ç½®æ­£ç¡® (`http://223.93.139.87:3002`)
- [x] å¼€å‘ç¯å¢ƒé…ç½®æ­£ç¡® (`http://localhost:3002`)
- [x] ç¡¬ç¼–ç åœ°å€å·²ä¿®å¤
- [x] å›¾ç‰‡è·¯å¾„å¤„ç†å·²ä¿®å¤
- [x] é…ç½®æ–‡ä»¶ä½¿ç”¨æ­£ç¡®
- [x] ç¯å¢ƒåˆ‡æ¢åŠŸèƒ½æ­£å¸¸
- [x] æµ‹è¯•è„šæœ¬å·²åˆ›å»º
- [x] æ–‡æ¡£å·²æ›´æ–°

## ğŸ“Š å½“å‰çŠ¶æ€

âœ… **å¾®ä¿¡å°ç¨‹åºAPIåœ°å€é…ç½®å·²å®Œæˆ**
- ç”Ÿäº§ç¯å¢ƒ: `http://223.93.139.87:3002`
- å¼€å‘ç¯å¢ƒ: `http://localhost:3002`
- æ‰€æœ‰APIè°ƒç”¨éƒ½ä½¿ç”¨é…ç½®æ–‡ä»¶
- å›¾ç‰‡è·¯å¾„å¤„ç†å·²ä¿®å¤
- æ”¯æŒç¯å¢ƒè‡ªåŠ¨åˆ‡æ¢

ç°åœ¨å°ç¨‹åºå¯ä»¥æ­£ç¡®è°ƒç”¨ç”Ÿäº§ç¯å¢ƒçš„APIåœ°å€äº†ï¼
