import{_ as e,r as a,a as l,h as t,c as u,o as s,d as n,w as o,f as i,E as r,k as d,b as c,p,q as m,s as v,g as f,F as y,m as g,l as h,t as _,y as b,G as k,z as w,e as V,x as C,v as x,B as U,j,n as A,H as z,A as B,D as S}from"./index-BGcfmTHn.js";import{q}from"./questionBank-CSjScX2A.js";import{s as I}from"./subject-0VsH4dJ8.js";import{a as $}from"./admin-CIxr_aSY.js";const N={class:"question-bank-management"},O={key:0,class:"bank-list-page"},Q={class:"card-header"},T={class:"header-actions"},J={class:"search-section"},D={class:"bank-grid"},E={class:"bank-info"},P={class:"bank-name"},W={class:"bank-description"},G={class:"bank-stats"},M={class:"stat-item"},F={class:"stat-item"},H={class:"stat-item"},L={class:"bank-actions"},R={class:"pagination"},K={key:1,class:"subject-list-page"},X={class:"card-header"},Y={class:"header-left"},Z={class:"bank-title"},ee={class:"header-actions"},ae={class:"subject-grid"},le={class:"subject-info"},te={class:"subject-name"},ue={class:"subject-description"},se={class:"subject-stats"},ne={class:"stat-item"},oe={class:"stat-item"},ie={class:"subject-actions"},re={key:2,class:"question-list-page"},de={class:"card-header"},ce={class:"header-left"},pe={class:"subject-title"},me={class:"header-actions"},ve={class:"pagination"},fe={key:0,class:"question-detail"},ye={key:0,class:"edit-form"},ge={class:"options-editor"},he={class:"image-upload-section"},_e={key:1},be={class:"question-content"},ke={key:0},we={class:"answer-section"},Ve={class:"answer"},Ce={key:1},xe={key:2},Ue={class:"images-grid"},je={class:"dialog-footer"},Ae={class:"options-container"},ze={class:"dialog-footer"},Be=e({__name:"QuestionBankManagement",setup(e){const Be=a(!1),Se=a([]),qe=a([]),Ie=a([]),$e=a([]),Ne=a(null),Oe=a(null),Qe=a(!1),Te=a(!1),Je=a(!1),De=a(!1),Ee=a(null),Pe=a(!1),We=a(!1),Ge=a(!1),Me=a({id:"",subject:"",chapter:"",type:"",difficulty:"",content:"",options:[],answer:"",analysis:"",images:[]}),Fe=a({chapter:"",type:"单选题",difficulty:"中等",content:"",options:[{key:"A",content:""},{key:"B",content:""}],answer:"",analysis:"",images:[]}),He=a(null),Le=a("https://practice.insightdata.top/api/upload/image"),Re=a({Authorization:`Bearer ${localStorage.getItem("token")}`}),Ke=l({keyword:""}),Xe=l({name:"",description:""}),Ye=l({name:"",description:""}),Ze=l({page:1,limit:10,total:0}),ea=e=>e?new Date(e).toLocaleString("zh-CN"):"-",aa=e=>({"单选题":"primary","多选题":"success","判断题":"warning","填空题":"info"}[e]||"default"),la=e=>({"简单":"success","中等":"warning","困难":"danger"}[e]||"default"),ta=async()=>{Be.value=!0;try{const e={page:Ze.page,limit:Ze.limit,...Ke};Object.keys(e).forEach(a=>{""===e[a]&&delete e[a]});const a=await q.getQuestionBanks(e);200===a.code?(Se.value=a.data.list||[],Ze.total=a.data.total||0):r.error(a.message||"获取题库列表失败")}catch(e){r.error("加载题库列表失败: "+e.message)}finally{Be.value=!1}},ua=async()=>{Be.value=!0;try{const e={page:Ze.page,limit:Ze.limit,questionBankId:Ne.value.id},a=await I.getSubjects(e);200===a.code?(qe.value=a.data.list||[],Ze.total=a.data.total||0):r.error(a.message||"获取科目列表失败")}catch(e){r.error("加载科目列表失败: "+e.message)}finally{Be.value=!1}},sa=async()=>{Be.value=!0;try{const e={page:Ze.page,limit:Ze.limit,subjectId:Oe.value.id},a=await $.getQuestions(e);200===a.code?(Ie.value=a.data.list||[],Ze.total=a.data.total||0):r.error(a.message||"获取题目列表失败")}catch(e){r.error("加载题目列表失败: "+e.message)}finally{Be.value=!1}},na=()=>{Ze.page=1,Oe.value?sa():Ne.value?ua():ta()},oa=()=>{Object.keys(Ke).forEach(e=>{Ke[e]=""}),Ze.page=1,Oe.value?sa():Ne.value?ua():ta()},ia=e=>{Ze.limit=e,Ze.page=1,Oe.value?sa():Ne.value?ua():ta()},ra=e=>{Ze.page=e,Oe.value?sa():Ne.value?ua():ta()},da=e=>{$e.value=e},ca=async()=>{if(0!==$e.value.length)try{await S.confirm(`确定要删除选中的 ${$e.value.length} 道题目吗？此操作不可恢复！`,"批量删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0});const e=$e.value.map(e=>e.id),a=await $.batchDeleteQuestions(e);200===a.code?(r.success(`成功删除 ${a.data.deletedCount} 道题目`),$e.value=[],sa()):r.error(a.message||"批量删除失败")}catch(e){"cancel"!==e&&r.error("批量删除失败: "+e.message)}else r.warning("请选择要删除的题目")},pa=e=>{Ne.value=e,Ze.page=1,ua()},ma=()=>{Ne.value=null,Oe.value=null,Ze.page=1,ta()},va=e=>{Oe.value=e,Ze.page=1,sa()},fa=()=>{Oe.value=null,Ze.page=1,ua()},ya=async()=>{try{const e=await q.createQuestionBank(Xe);200===e.code?(r.success("创建题库成功"),Qe.value=!1,Xe.name="",Xe.description="",ta()):r.error(e.message||"创建题库失败")}catch(e){r.error("创建题库失败: "+e.message)}},ga=async()=>{try{const e={...Ye,questionBankId:Ne.value.id},a=await I.createSubject(e);200===a.code?(r.success("创建科目成功"),Te.value=!1,Ye.name="",Ye.description="",ua()):r.error(a.message||"创建科目失败")}catch(e){r.error("创建科目失败: "+e.message)}},ha=()=>{Ee.value&&(Me.value={id:Ee.value.id,subject:Ee.value.subject,chapter:Ee.value.chapter||"",type:Ee.value.type,difficulty:Ee.value.difficulty||"简单",content:Ee.value.content,options:_a(Ee.value.options),answer:Ee.value.answer,analysis:Ee.value.analysis||"",images:ba(Ee.value.images)},Pe.value=!0)},_a=e=>{if(!e)return[];try{if("string"==typeof e){const a=JSON.parse(e);if(Array.isArray(a))return a.map(e=>({content:"string"==typeof e?e:e.content||""}))}return Array.isArray(e)?e.map(e=>({content:"string"==typeof e?e:e.content||""})):[]}catch(a){return[]}},ba=e=>{if(!e)return[];try{let a=[];if("string"==typeof e){const l=JSON.parse(e);Array.isArray(l)&&(a=l)}else Array.isArray(e)&&(a=e);return a.filter(e=>e&&"object"==typeof e&&e.path&&"string"==typeof e.path).map(e=>({name:e.name||"image",url:ka(e.path),path:e.path}))}catch(a){return[]}},ka=e=>{if(!e||"string"!=typeof e)return"";if(e.startsWith("http"))return e;let a=e.trim();a.startsWith("/")&&(a=a.substring(1)),a.startsWith("images/")||(a=`images/${a}`);return`https://practice.insightdata.top/uploads/${a}`},wa=()=>{if(!Ee.value?.images)return[];try{const e="string"==typeof Ee.value.images?JSON.parse(Ee.value.images):Ee.value.images;return Array.isArray(e)?e.filter(e=>e&&"object"==typeof e&&e.path&&"string"==typeof e.path&&""!==e.path.trim()):[]}catch(e){return[]}},Va=()=>{Me.value.options.length<6&&Me.value.options.push({content:""})},Ca=async()=>{if(Me.value.content.trim())if(Me.value.options.length<2)r.error("至少需要2个选项");else if(Me.value.answer.trim()){We.value=!0;try{let e=[];Me.value.images&&Array.isArray(Me.value.images)&&(e=Me.value.images.filter(e=>e&&e.path&&"string"==typeof e.path&&""!==e.path.trim()).map(e=>({path:e.path})));const a={chapter:Me.value.chapter,type:Me.value.type,difficulty:Me.value.difficulty,content:Me.value.content,options:JSON.stringify(Me.value.options.map(e=>e.content)),answer:Me.value.answer,analysis:Me.value.analysis,images:JSON.stringify(e)},l=await $.updateQuestion(Me.value.id,a);200===l.code?(r.success("保存成功"),Pe.value=!1,De.value=!1,sa()):r.error(l.message||"保存失败")}catch(e){r.error("保存失败: "+e.message)}finally{We.value=!1}}else r.error("请输入正确答案");else r.error("请输入题目内容")},xa=(e,a,l)=>{if(200===e.code){const l={name:a.name,url:e.data.url,path:e.data.path};Me.value.images.push(l),r.success("图片上传成功")}else r.error(e.message||"图片上传失败")},Ua=(e,a)=>{if(Me.value.images&&Array.isArray(Me.value.images)){const a=Me.value.images.findIndex(a=>a.name===e.name||a.path===e.path||a.url===e.url);a>-1&&Me.value.images.splice(a,1)}r.success("图片删除成功")},ja=(e,a,l)=>{r.error("图片上传失败")},Aa=e=>{const a=e.type.startsWith("image/"),l=e.size/1024/1024<2;return a?!!l||(r.error("图片大小不能超过 2MB!"),!1):(r.error("只能上传图片文件!"),!1)},za=()=>{Fe.value={chapter:"",type:"单选题",difficulty:"中等",content:"",options:[{key:"A",content:""},{key:"B",content:""}],answer:"",analysis:"",images:[]},Je.value=!0},Ba=()=>{Je.value=!1,Fe.value={chapter:"",type:"单选题",difficulty:"中等",content:"",options:[{key:"A",content:""},{key:"B",content:""}],answer:"",analysis:"",images:[]}},Sa=()=>{if(Fe.value.options.length<6){const e=String.fromCharCode(65+Fe.value.options.length);Fe.value.options.push({key:e,content:""})}},qa=async()=>{if(He.value){try{await He.value.validate()}catch(e){return void r.error("请完善必填信息")}if(Fe.value.content.trim())if(("单选题"===Fe.value.type||"多选题"===Fe.value.type)&&Fe.value.options.length<2)r.error("至少需要2个选项");else if(Fe.value.answer.trim()){Ge.value=!0;try{const e={questionBankId:Ne.value.id,subjectId:Oe.value.id,chapter:Fe.value.chapter,type:Fe.value.type,difficulty:Fe.value.difficulty,content:Fe.value.content,answer:Fe.value.answer,analysis:Fe.value.analysis,options:"单选题"===Fe.value.type||"多选题"===Fe.value.type?JSON.stringify(Fe.value.options):null,images:Fe.value.images.length>0?JSON.stringify(Fe.value.images):null},a=await $.addQuestion(e);200===a.code?(r.success("题目创建成功"),Je.value=!1,sa()):r.error(a.message||"创建失败")}catch(e){r.error("创建题目失败: "+e.message)}finally{Ge.value=!1}}else r.error("请输入正确答案");else r.error("请输入题目内容")}},Ia=(e,a,l)=>{200===e.code?(Fe.value.images.push({name:e.data.fileName,path:e.data.path,url:ka(e.data.path)}),r.success("图片上传成功")):r.error(e.message||"图片上传失败")},$a=(e,a,l)=>{r.error("图片上传失败")},Na=(e,a)=>{const l=Fe.value.images.findIndex(a=>a.name===e.name);l>-1&&Fe.value.images.splice(l,1)};return t(()=>{ta()}),(e,a)=>{const l=i("el-icon"),t=i("el-button"),_a=i("el-input"),ba=i("el-col"),Oa=i("el-row"),Qa=i("el-card"),Ta=i("el-pagination"),Ja=i("el-table-column"),Da=i("el-tag"),Ea=i("el-table"),Pa=i("el-form-item"),Wa=i("el-form"),Ga=i("el-dialog"),Ma=i("el-option"),Fa=i("el-select"),Ha=i("el-upload"),La=i("el-descriptions-item"),Ra=i("el-descriptions"),Ka=i("el-image"),Xa=i("el-radio"),Ya=i("el-radio-group"),Za=d("loading");return s(),u("div",N,[Ne.value?Oe.value?(s(),u("div",re,[n(Qa,null,{header:o(()=>[c("div",de,[c("div",ce,[n(t,{onClick:fa,type:"text"},{default:o(()=>[n(l,null,{default:o(()=>[n(m(U))]),_:1}),a[46]||(a[46]=f(" 返回科目列表 ",-1))]),_:1}),c("span",pe,_(Oe.value.name),1)]),c("div",me,[$e.value.length>0?(s(),h(t,{key:0,type:"danger",onClick:ca,disabled:0===$e.value.length},{default:o(()=>[n(l,null,{default:o(()=>[n(m(z))]),_:1}),f(" 批量删除 ("+_($e.value.length)+") ",1)]),_:1},8,["disabled"])):A("",!0),n(t,{type:"success",onClick:za},{default:o(()=>[n(l,null,{default:o(()=>[n(m(C))]),_:1}),a[47]||(a[47]=f(" 添加题目 ",-1))]),_:1}),n(t,{type:"primary",onClick:a[5]||(a[5]=a=>e.$router.push("/smart-question-import"))},{default:o(()=>[n(l,null,{default:o(()=>[n(m(B))]),_:1}),a[48]||(a[48]=f(" 智能上传 ",-1))]),_:1}),n(t,{onClick:sa},{default:o(()=>[n(l,null,{default:o(()=>[n(m(x))]),_:1}),a[49]||(a[49]=f(" 刷新 ",-1))]),_:1})])])]),default:o(()=>[j((s(),h(Ea,{data:Ie.value,onSelectionChange:da},{default:o(()=>[n(Ja,{type:"selection",width:"55"}),n(Ja,{prop:"id",label:"ID",width:"80"}),n(Ja,{prop:"content",label:"题目内容","min-width":"300","show-overflow-tooltip":""}),n(Ja,{prop:"type",label:"类型",width:"100"},{default:o(({row:e})=>[n(Da,{type:aa(e.type)},{default:o(()=>[f(_(e.type),1)]),_:2},1032,["type"])]),_:1}),n(Ja,{prop:"difficulty",label:"难度",width:"100"},{default:o(({row:e})=>[n(Da,{type:la(e.difficulty)},{default:o(()=>[f(_(e.difficulty),1)]),_:2},1032,["type"])]),_:1}),n(Ja,{prop:"createdAt",label:"创建时间",width:"180"},{default:o(({row:e})=>[f(_(ea(e.createdAt)),1)]),_:1}),n(Ja,{label:"操作",width:"150",fixed:"right"},{default:o(({row:e})=>[n(t,{size:"small",onClick:a=>{return l=e,Ee.value=l,De.value=!0,void ha();var l}},{default:o(()=>[...a[50]||(a[50]=[f("编辑",-1)])]),_:1},8,["onClick"]),n(t,{size:"small",type:"danger",onClick:a=>(async e=>{try{await S.confirm(`确定要删除题目"${e.content.substring(0,50)}..."吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=await $.deleteQuestion(e.id);200===a.code?(r.success("删除成功"),sa()):r.error(a.message||"删除失败")}catch(a){"cancel"!==a&&r.error("删除失败: "+a.message)}})(e)},{default:o(()=>[...a[51]||(a[51]=[f("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[Za,Be.value]]),c("div",ve,[n(Ta,{"current-page":Ze.page,"onUpdate:currentPage":a[6]||(a[6]=e=>Ze.page=e),"page-size":Ze.limit,"onUpdate:pageSize":a[7]||(a[7]=e=>Ze.limit=e),"page-sizes":[10,20,50,100],total:Ze.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:ia,onCurrentChange:ra},null,8,["current-page","page-size","total"])])]),_:1})])):(s(),u("div",K,[n(Qa,null,{header:o(()=>[c("div",X,[c("div",Y,[n(t,{onClick:ma,type:"text"},{default:o(()=>[n(l,null,{default:o(()=>[n(m(U))]),_:1}),a[41]||(a[41]=f(" 返回题库列表 ",-1))]),_:1}),c("span",Z,_(Ne.value.name),1)]),c("div",ee,[n(t,{type:"primary",onClick:a[4]||(a[4]=e=>Te.value=!0)},{default:o(()=>[n(l,null,{default:o(()=>[n(m(C))]),_:1}),a[42]||(a[42]=f(" 创建科目 ",-1))]),_:1}),n(t,{onClick:ua},{default:o(()=>[n(l,null,{default:o(()=>[n(m(x))]),_:1}),a[43]||(a[43]=f(" 刷新 ",-1))]),_:1})])])]),default:o(()=>[c("div",ae,[(s(!0),u(y,null,g(qe.value,e=>(s(),h(Qa,{key:e.id,class:"subject-card",shadow:"hover",onClick:a=>va(e)},{default:o(()=>[c("div",le,[c("h3",te,_(e.name),1),c("p",ue,_(e.description||"暂无描述"),1),c("div",se,[c("span",ne,[n(l,null,{default:o(()=>[n(m(k))]),_:1}),f(" "+_(e.questionCount||0)+" 道题目 ",1)]),c("span",oe,[n(l,null,{default:o(()=>[n(m(w))]),_:1}),f(" "+_(ea(e.createdAt)),1)])])]),c("div",ie,[n(t,{size:"small",type:"primary",onClick:V(a=>va(e),["stop"])},{default:o(()=>[...a[44]||(a[44]=[f(" 进入科目 ",-1)])]),_:1},8,["onClick"]),n(t,{size:"small",type:"danger",onClick:V(a=>(async e=>{try{await S.confirm(`确定要删除科目"${e.name}"吗？这将删除该科目下的所有题目。`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=await I.deleteSubject(e.id);200===a.code?(r.success("删除科目成功"),ua()):r.error(a.message||"删除失败")}catch(a){"cancel"!==a&&r.error("删除失败: "+a.message)}})(e),["stop"])},{default:o(()=>[...a[45]||(a[45]=[f(" 删除 ",-1)])]),_:1},8,["onClick"])])]),_:2},1032,["onClick"]))),128))])]),_:1})])):(s(),u("div",O,[n(Qa,null,{header:o(()=>[c("div",Q,[a[36]||(a[36]=c("span",null,"题库管理",-1)),c("div",T,[n(t,{type:"primary",onClick:a[0]||(a[0]=e=>Qe.value=!0)},{default:o(()=>[n(l,null,{default:o(()=>[n(m(C))]),_:1}),a[34]||(a[34]=f(" 创建题库 ",-1))]),_:1}),n(t,{onClick:ta},{default:o(()=>[n(l,null,{default:o(()=>[n(m(x))]),_:1}),a[35]||(a[35]=f(" 刷新 ",-1))]),_:1})])])]),default:o(()=>[c("div",J,[n(Oa,{gutter:20},{default:o(()=>[n(ba,{span:6},{default:o(()=>[n(_a,{modelValue:Ke.keyword,"onUpdate:modelValue":a[1]||(a[1]=e=>Ke.keyword=e),placeholder:"搜索题库名称",clearable:"",onKeyup:p(na,["enter"])},{prefix:o(()=>[n(l,null,{default:o(()=>[n(m(v))]),_:1})]),_:1},8,["modelValue"])]),_:1}),n(ba,{span:4},{default:o(()=>[n(t,{type:"primary",onClick:na},{default:o(()=>[n(l,null,{default:o(()=>[n(m(v))]),_:1}),a[37]||(a[37]=f(" 搜索 ",-1))]),_:1}),n(t,{onClick:oa},{default:o(()=>[...a[38]||(a[38]=[f("重置",-1)])]),_:1})]),_:1})]),_:1})]),c("div",D,[(s(!0),u(y,null,g(Se.value,e=>(s(),h(Qa,{key:e.id,class:"bank-card",shadow:"hover",onClick:a=>pa(e)},{default:o(()=>[c("div",E,[c("h3",P,_(e.name),1),c("p",W,_(e.description||"暂无描述"),1),c("div",G,[c("span",M,[n(l,null,{default:o(()=>[n(m(b))]),_:1}),f(" "+_(e.subjectCount||0)+" 个科目 ",1)]),c("span",F,[n(l,null,{default:o(()=>[n(m(k))]),_:1}),f(" "+_(e.questionCount||0)+" 道题目 ",1)]),c("span",H,[n(l,null,{default:o(()=>[n(m(w))]),_:1}),f(" "+_(ea(e.createdAt)),1)])])]),c("div",L,[n(t,{size:"small",type:"primary",onClick:V(a=>pa(e),["stop"])},{default:o(()=>[...a[39]||(a[39]=[f(" 进入题库 ",-1)])]),_:1},8,["onClick"]),n(t,{size:"small",type:"danger",onClick:V(a=>(async e=>{try{await S.confirm(`确定要删除题库"${e.name}"吗？这将删除该题库下的所有科目和题目。`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=await q.deleteQuestionBank(e.id);200===a.code?(r.success("删除题库成功"),ta()):r.error(a.message||"删除失败")}catch(a){"cancel"!==a&&r.error("删除失败: "+a.message)}})(e),["stop"])},{default:o(()=>[...a[40]||(a[40]=[f(" 删除 ",-1)])]),_:1},8,["onClick"])])]),_:2},1032,["onClick"]))),128))]),c("div",R,[n(Ta,{"current-page":Ze.page,"onUpdate:currentPage":a[2]||(a[2]=e=>Ze.page=e),"page-size":Ze.limit,"onUpdate:pageSize":a[3]||(a[3]=e=>Ze.limit=e),"page-sizes":[10,20,50,100],total:Ze.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:ia,onCurrentChange:ra},null,8,["current-page","page-size","total"])])]),_:1})])),n(Ga,{modelValue:Qe.value,"onUpdate:modelValue":a[11]||(a[11]=e=>Qe.value=e),title:"创建题库",width:"500px"},{footer:o(()=>[n(t,{onClick:a[10]||(a[10]=e=>Qe.value=!1)},{default:o(()=>[...a[52]||(a[52]=[f("取消",-1)])]),_:1}),n(t,{type:"primary",onClick:ya},{default:o(()=>[...a[53]||(a[53]=[f("确定",-1)])]),_:1})]),default:o(()=>[n(Wa,{model:Xe,"label-width":"100px"},{default:o(()=>[n(Pa,{label:"题库名称",required:""},{default:o(()=>[n(_a,{modelValue:Xe.name,"onUpdate:modelValue":a[8]||(a[8]=e=>Xe.name=e),placeholder:"请输入题库名称"},null,8,["modelValue"])]),_:1}),n(Pa,{label:"题库描述"},{default:o(()=>[n(_a,{modelValue:Xe.description,"onUpdate:modelValue":a[9]||(a[9]=e=>Xe.description=e),type:"textarea",rows:3,placeholder:"请输入题库描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),n(Ga,{modelValue:Te.value,"onUpdate:modelValue":a[15]||(a[15]=e=>Te.value=e),title:"创建科目",width:"500px"},{footer:o(()=>[n(t,{onClick:a[14]||(a[14]=e=>Te.value=!1)},{default:o(()=>[...a[54]||(a[54]=[f("取消",-1)])]),_:1}),n(t,{type:"primary",onClick:ga},{default:o(()=>[...a[55]||(a[55]=[f("确定",-1)])]),_:1})]),default:o(()=>[n(Wa,{model:Ye,"label-width":"100px"},{default:o(()=>[n(Pa,{label:"科目名称",required:""},{default:o(()=>[n(_a,{modelValue:Ye.name,"onUpdate:modelValue":a[12]||(a[12]=e=>Ye.name=e),placeholder:"请输入科目名称"},null,8,["modelValue"])]),_:1}),n(Pa,{label:"科目描述"},{default:o(()=>[n(_a,{modelValue:Ye.description,"onUpdate:modelValue":a[13]||(a[13]=e=>Ye.description=e),type:"textarea",rows:3,placeholder:"请输入科目描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),n(Ga,{modelValue:De.value,"onUpdate:modelValue":a[25]||(a[25]=e=>De.value=e),title:Pe.value?"编辑题目":"题目详情",width:"900px","close-on-click-modal":!1},{footer:o(()=>[c("div",je,[n(t,{onClick:a[24]||(a[24]=e=>De.value=!1)},{default:o(()=>[...a[64]||(a[64]=[f("取消",-1)])]),_:1}),Pe.value?(s(),h(t,{key:0,type:"primary",loading:We.value,onClick:Ca},{default:o(()=>[...a[65]||(a[65]=[f(" 保存 ",-1)])]),_:1},8,["loading"])):(s(),h(t,{key:1,type:"primary",onClick:ha},{default:o(()=>[...a[66]||(a[66]=[f("编辑",-1)])]),_:1}))])]),default:o(()=>[Ee.value?(s(),u("div",fe,[Pe.value?(s(),u("div",ye,[n(Wa,{model:Me.value,"label-width":"100px","label-position":"left"},{default:o(()=>[n(Oa,{gutter:20},{default:o(()=>[n(ba,{span:12},{default:o(()=>[n(Pa,{label:"题目ID"},{default:o(()=>[n(_a,{modelValue:Me.value.id,"onUpdate:modelValue":a[16]||(a[16]=e=>Me.value.id=e),disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),n(ba,{span:12},{default:o(()=>[n(Pa,{label:"科目"},{default:o(()=>[n(_a,{modelValue:Me.value.subject,"onUpdate:modelValue":a[17]||(a[17]=e=>Me.value.subject=e),disabled:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(Oa,{gutter:20},{default:o(()=>[n(ba,{span:12},{default:o(()=>[n(Pa,{label:"章节"},{default:o(()=>[n(_a,{modelValue:Me.value.chapter,"onUpdate:modelValue":a[18]||(a[18]=e=>Me.value.chapter=e)},null,8,["modelValue"])]),_:1})]),_:1}),n(ba,{span:12},{default:o(()=>[n(Pa,{label:"类型"},{default:o(()=>[n(Fa,{modelValue:Me.value.type,"onUpdate:modelValue":a[19]||(a[19]=e=>Me.value.type=e),style:{width:"100%"}},{default:o(()=>[n(Ma,{label:"单选题",value:"单选题"}),n(Ma,{label:"多选题",value:"多选题"}),n(Ma,{label:"判断题",value:"判断题"}),n(Ma,{label:"填空题",value:"填空题"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(Oa,{gutter:20},{default:o(()=>[n(ba,{span:12},{default:o(()=>[n(Pa,{label:"难度"},{default:o(()=>[n(Fa,{modelValue:Me.value.difficulty,"onUpdate:modelValue":a[20]||(a[20]=e=>Me.value.difficulty=e),style:{width:"100%"}},{default:o(()=>[n(Ma,{label:"简单",value:"简单"}),n(Ma,{label:"中等",value:"中等"}),n(Ma,{label:"困难",value:"困难"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),n(ba,{span:12},{default:o(()=>[n(Pa,{label:"正确答案"},{default:o(()=>[n(_a,{modelValue:Me.value.answer,"onUpdate:modelValue":a[21]||(a[21]=e=>Me.value.answer=e),placeholder:"如：A、AB、正确等"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(Pa,{label:"题目内容"},{default:o(()=>[n(_a,{modelValue:Me.value.content,"onUpdate:modelValue":a[22]||(a[22]=e=>Me.value.content=e),type:"textarea",rows:4,placeholder:"请输入题目内容"},null,8,["modelValue"])]),_:1}),n(Pa,{label:"选项"},{default:o(()=>[c("div",ge,[(s(!0),u(y,null,g(Me.value.options,(e,l)=>(s(),u("div",{key:l,class:"option-item"},[n(_a,{modelValue:Me.value.options[l].content,"onUpdate:modelValue":e=>Me.value.options[l].content=e,placeholder:`选项 ${String.fromCharCode(65+l)}`},{prepend:o(()=>[f(_(String.fromCharCode(65+l))+".",1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"]),Me.value.options.length>2?(s(),h(t,{key:0,type:"danger",size:"small",onClick:e=>(e=>{Me.value.options.length>2&&Me.value.options.splice(e,1)})(l)},{default:o(()=>[...a[56]||(a[56]=[f(" 删除 ",-1)])]),_:1},8,["onClick"])):A("",!0)]))),128)),Me.value.options.length<6?(s(),h(t,{key:0,type:"primary",size:"small",onClick:Va},{default:o(()=>[...a[57]||(a[57]=[f(" 添加选项 ",-1)])]),_:1})):A("",!0)])]),_:1}),n(Pa,{label:"解析"},{default:o(()=>[n(_a,{modelValue:Me.value.analysis,"onUpdate:modelValue":a[23]||(a[23]=e=>Me.value.analysis=e),type:"textarea",rows:3,placeholder:"请输入题目解析"},null,8,["modelValue"])]),_:1}),n(Pa,{label:"解析图片"},{default:o(()=>[c("div",he,[n(Ha,{ref:"imageUploadRef",action:Le.value,headers:Re.value,"on-success":xa,"on-error":ja,"on-remove":Ua,"before-upload":Aa,"file-list":Me.value.images,"list-type":"picture-card",limit:5,accept:"image/*"},{default:o(()=>[n(l,null,{default:o(()=>[n(m(C))]),_:1})]),_:1},8,["action","headers","file-list"]),a[58]||(a[58]=c("div",{class:"upload-tip"}," 支持上传JPG、PNG格式图片，最多5张 ",-1))])]),_:1})]),_:1},8,["model"])])):(s(),u("div",_e,[n(Ra,{column:2,border:""},{default:o(()=>[n(La,{label:"题目ID"},{default:o(()=>[f(_(Ee.value.id),1)]),_:1}),n(La,{label:"科目"},{default:o(()=>[f(_(Ee.value.subject),1)]),_:1}),n(La,{label:"章节"},{default:o(()=>[f(_(Ee.value.chapter),1)]),_:1}),n(La,{label:"类型"},{default:o(()=>[n(Da,{type:aa(Ee.value.type)},{default:o(()=>{return[f(_((e=Ee.value.type,{"单选题":"单选题","多选题":"多选题","判断题":"判断题","填空题":"填空题"}[e]||e)),1)];var e}),_:1},8,["type"])]),_:1}),n(La,{label:"难度"},{default:o(()=>[n(Da,{type:la(Ee.value.difficulty)},{default:o(()=>[f(_(Ee.value.difficulty),1)]),_:1},8,["type"])]),_:1}),n(La,{label:"创建时间"},{default:o(()=>[f(_(ea(Ee.value.createdAt)),1)]),_:1})]),_:1}),c("div",be,[a[63]||(a[63]=c("h4",null,"题目内容：",-1)),c("p",null,_(Ee.value.content),1),Ee.value.options&&Ee.value.options.length>0?(s(),u("div",ke,[a[59]||(a[59]=c("h4",null,"选项：",-1)),c("ul",null,[(s(!0),u(y,null,g(Ee.value.options,(e,a)=>(s(),u("li",{key:a},_(String.fromCharCode(65+a))+". "+_(e.content||e),1))),128))])])):A("",!0),c("div",we,[a[60]||(a[60]=c("h4",null,"正确答案：",-1)),c("p",Ve,_(Ee.value.answer),1)]),Ee.value.analysis?(s(),u("div",Ce,[a[61]||(a[61]=c("h4",null,"解析：",-1)),c("p",null,_(Ee.value.analysis),1)])):A("",!0),Ee.value.images&&Ee.value.images.length>0?(s(),u("div",xe,[a[62]||(a[62]=c("h4",null,"解析图片：",-1)),c("div",Ue,[(s(!0),u(y,null,g(wa(),(e,a)=>(s(),h(Ka,{key:a,src:ka(e.path),"preview-src-list":wa().map(e=>ka(e.path)),fit:"cover",class:"analysis-image"},null,8,["src","preview-src-list"]))),128))])])):A("",!0)])]))])):A("",!0)]),_:1},8,["modelValue","title"]),n(Ga,{modelValue:Je.value,"onUpdate:modelValue":a[33]||(a[33]=e=>Je.value=e),title:"创建题目",width:"800px","close-on-click-modal":!1},{footer:o(()=>[c("div",ze,[n(t,{onClick:Ba},{default:o(()=>[...a[71]||(a[71]=[f("取消",-1)])]),_:1}),n(t,{type:"primary",loading:Ge.value,onClick:qa},{default:o(()=>[...a[72]||(a[72]=[f(" 创建 ",-1)])]),_:1},8,["loading"])])]),default:o(()=>[n(Wa,{model:Fe.value,"label-width":"100px",ref_key:"createFormRef",ref:He},{default:o(()=>[n(Pa,{label:"题目内容",prop:"content",rules:[{required:!0,message:"请输入题目内容",trigger:"blur"}]},{default:o(()=>[n(_a,{modelValue:Fe.value.content,"onUpdate:modelValue":a[26]||(a[26]=e=>Fe.value.content=e),type:"textarea",rows:3,placeholder:"请输入题目内容"},null,8,["modelValue"])]),_:1}),n(Pa,{label:"题目类型",prop:"type",rules:[{required:!0,message:"请选择题目类型",trigger:"change"}]},{default:o(()=>[n(Fa,{modelValue:Fe.value.type,"onUpdate:modelValue":a[27]||(a[27]=e=>Fe.value.type=e),placeholder:"请选择题目类型",style:{width:"100%"}},{default:o(()=>[n(Ma,{label:"单选题",value:"单选题"}),n(Ma,{label:"多选题",value:"多选题"}),n(Ma,{label:"判断题",value:"判断题"}),n(Ma,{label:"填空题",value:"填空题"})]),_:1},8,["modelValue"])]),_:1}),n(Pa,{label:"难度等级",prop:"difficulty"},{default:o(()=>[n(Fa,{modelValue:Fe.value.difficulty,"onUpdate:modelValue":a[28]||(a[28]=e=>Fe.value.difficulty=e),placeholder:"请选择难度等级",style:{width:"100%"}},{default:o(()=>[n(Ma,{label:"简单",value:"简单"}),n(Ma,{label:"中等",value:"中等"}),n(Ma,{label:"困难",value:"困难"})]),_:1},8,["modelValue"])]),_:1}),n(Pa,{label:"章节",prop:"chapter"},{default:o(()=>[n(_a,{modelValue:Fe.value.chapter,"onUpdate:modelValue":a[29]||(a[29]=e=>Fe.value.chapter=e),placeholder:"请输入章节名称"},null,8,["modelValue"])]),_:1}),"单选题"===Fe.value.type||"多选题"===Fe.value.type?(s(),h(Pa,{key:0,label:"选项配置"},{default:o(()=>[c("div",Ae,[(s(!0),u(y,null,g(Fe.value.options,(e,l)=>(s(),u("div",{key:l,class:"option-item"},[n(_a,{modelValue:e.key,"onUpdate:modelValue":a=>e.key=a,placeholder:"选项标识",style:{width:"80px","margin-right":"10px"},disabled:""},null,8,["modelValue","onUpdate:modelValue"]),n(_a,{modelValue:e.content,"onUpdate:modelValue":a=>e.content=a,placeholder:"选项内容",style:{flex:"1","margin-right":"10px"}},null,8,["modelValue","onUpdate:modelValue"]),Fe.value.options.length>2?(s(),h(t,{key:0,type:"danger",size:"small",onClick:e=>(e=>{Fe.value.options.length>2&&(Fe.value.options.splice(e,1),Fe.value.options.forEach((e,a)=>{e.key=String.fromCharCode(65+a)}))})(l)},{default:o(()=>[...a[67]||(a[67]=[f(" 删除 ",-1)])]),_:1},8,["onClick"])):A("",!0)]))),128)),Fe.value.options.length<6?(s(),h(t,{key:0,type:"primary",size:"small",onClick:Sa},{default:o(()=>[...a[68]||(a[68]=[f(" 添加选项 ",-1)])]),_:1})):A("",!0)])]),_:1})):A("",!0),"判断题"===Fe.value.type?(s(),h(Pa,{key:1,label:"选项"},{default:o(()=>[n(Ya,{modelValue:Fe.value.answer,"onUpdate:modelValue":a[30]||(a[30]=e=>Fe.value.answer=e)},{default:o(()=>[n(Xa,{label:"正确"},{default:o(()=>[...a[69]||(a[69]=[f("正确",-1)])]),_:1}),n(Xa,{label:"错误"},{default:o(()=>[...a[70]||(a[70]=[f("错误",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})):A("",!0),n(Pa,{label:"正确答案",prop:"answer",rules:[{required:!0,message:"请输入正确答案",trigger:"blur"}]},{default:o(()=>["判断题"!==Fe.value.type?(s(),h(_a,{key:0,modelValue:Fe.value.answer,"onUpdate:modelValue":a[31]||(a[31]=e=>Fe.value.answer=e),placeholder:"请输入正确答案，如：A、AB、正确等"},null,8,["modelValue"])):A("",!0)]),_:1}),n(Pa,{label:"解析",prop:"analysis"},{default:o(()=>[n(_a,{modelValue:Fe.value.analysis,"onUpdate:modelValue":a[32]||(a[32]=e=>Fe.value.analysis=e),type:"textarea",rows:3,placeholder:"请输入题目解析"},null,8,["modelValue"])]),_:1}),n(Pa,{label:"解析图片"},{default:o(()=>[n(Ha,{action:"https://practice.insightdata.top/api/upload/image",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},"on-success":Ia,"on-error":$a,"before-upload":Aa,"file-list":Fe.value.images,"list-type":"picture-card",limit:5,"on-remove":Na},{default:o(()=>[n(l,null,{default:o(()=>[n(m(C))]),_:1})]),_:1},8,["action","headers","file-list"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-22aa6b46"]]);export{Be as default};
