import{_ as e,r as a,a as l,h as t,c as u,o as s,d as n,w as o,f as i,E as r,k as d,b as c,p,q as m,s as v,g as f,F as y,m as g,l as h,t as _,C as b,J as k,D as w,e as V,A as C,v as x,H as U,j,n as z,z as A,G as B,B as S}from"./index-vjfECZ1V.js";import{q}from"./questionBank-DsLT08V-.js";import{s as I}from"./subject-Bo8tLPDs.js";import{a as $}from"./admin-LlGWaIZt.js";const N={class:"question-bank-management"},Q={key:0,class:"bank-list-page"},J={class:"card-header"},O={class:"header-actions"},T={class:"search-section"},D={class:"bank-grid"},E={class:"bank-info"},P={class:"bank-name"},W={class:"bank-description"},G={class:"bank-stats"},M={class:"stat-item"},F={class:"stat-item"},H={class:"stat-item"},L={class:"bank-actions"},R={class:"pagination"},K={key:1,class:"subject-list-page"},X={class:"card-header"},Y={class:"header-left"},Z={class:"bank-title"},ee={class:"header-actions"},ae={class:"subject-grid"},le={class:"subject-info"},te={class:"subject-name"},ue={class:"subject-description"},se={class:"subject-stats"},ne={class:"stat-item"},oe={class:"stat-item"},ie={class:"subject-actions"},re={key:2,class:"question-list-page"},de={class:"card-header"},ce={class:"header-left"},pe={class:"subject-title"},me={class:"header-actions"},ve={class:"pagination"},fe={key:0,class:"question-detail"},ye={key:0,class:"edit-form"},ge={class:"options-editor"},he={class:"image-upload-section"},_e={key:1},be={class:"question-content"},ke={key:0},we={class:"answer-section"},Ve={class:"answer"},Ce={key:1},xe={key:2},Ue={class:"images-grid"},je={class:"dialog-footer"},ze={class:"options-container"},Ae={class:"dialog-footer"},Be=e({__name:"QuestionBankManagement",setup(e){const Be=a(!1),Se=a([]),qe=a([]),Ie=a([]),$e=a([]),Ne=a(null),Qe=a(null),Je=a(!1),Oe=a(!1),Te=a(!1),De=a(!1),Ee=a(null),Pe=a(!1),We=a(!1),Ge=a(!1),Me=a(null),Fe=a(null),He=a({id:"",subject:"",chapter:"",type:"",difficulty:"",content:"",options:[],answer:"",analysis:"",images:[]}),Le=a({chapter:"",type:"单选题",difficulty:"中等",content:"",options:[{key:"A",content:""},{key:"B",content:""}],answer:"",analysis:"",images:[]}),Re=a(null),Ke=a("/api/upload/image"),Xe=a({Authorization:`Bearer ${localStorage.getItem("token")}`}),Ye=l({keyword:""}),Ze=l({name:"",description:""}),ea=l({name:"",description:""}),aa=l({page:1,limit:10,total:0}),la=e=>e?new Date(e).toLocaleString("zh-CN"):"-",ta=e=>({"单选题":"primary","多选题":"success","判断题":"warning","填空题":"info"}[e]||"default"),ua=e=>({"简单":"success","中等":"warning","困难":"danger"}[e]||"default"),sa=async()=>{Be.value=!0;try{const e={page:aa.page,limit:aa.limit,...Ye};Object.keys(e).forEach(a=>{""===e[a]&&delete e[a]});const a=await q.getQuestionBanks(e);200===a.code?(Se.value=a.data.list||[],aa.total=a.data.total||0):r.error(a.message||"获取题库列表失败")}catch(e){r.error("加载题库列表失败: "+e.message)}finally{Be.value=!1}},na=async()=>{Be.value=!0;try{const e={page:aa.page,limit:aa.limit,questionBankId:Ne.value.id},a=await I.getSubjects(e);200===a.code?(qe.value=a.data.list||[],aa.total=a.data.total||0):r.error(a.message||"获取科目列表失败")}catch(e){r.error("加载科目列表失败: "+e.message)}finally{Be.value=!1}},oa=async()=>{Be.value=!0;try{const e={page:aa.page,limit:aa.limit,subjectId:Qe.value.id},a=await $.getQuestions(e);200===a.code?(Ie.value=a.data.list||[],aa.total=a.data.total||0):r.error(a.message||"获取题目列表失败")}catch(e){r.error("加载题目列表失败: "+e.message)}finally{Be.value=!1}},ia=()=>{aa.page=1,Qe.value?oa():Ne.value?na():sa()},ra=()=>{Object.keys(Ye).forEach(e=>{Ye[e]=""}),aa.page=1,Qe.value?oa():Ne.value?na():sa()},da=e=>{aa.limit=e,aa.page=1,Qe.value?oa():Ne.value?na():sa()},ca=e=>{aa.page=e,Qe.value?oa():Ne.value?na():sa()},pa=e=>{$e.value=e},ma=async()=>{if(0!==$e.value.length)try{await S.confirm(`确定要删除选中的 ${$e.value.length} 道题目吗？此操作不可恢复！`,"批量删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0});const e=$e.value.map(e=>e.id),a=await $.batchDeleteQuestions(e);200===a.code?(r.success(`成功删除 ${a.data.deletedCount} 道题目`),$e.value=[],oa()):r.error(a.message||"批量删除失败")}catch(e){"cancel"!==e&&r.error("批量删除失败: "+e.message)}else r.warning("请选择要删除的题目")},va=e=>{Ne.value=e,aa.page=1,na()},fa=()=>{Ne.value=null,Qe.value=null,aa.page=1,sa()},ya=e=>{Qe.value=e,aa.page=1,oa()},ga=()=>{Qe.value=null,aa.page=1,na()},ha=()=>{Je.value=!1,Me.value=null,Ze.name="",Ze.description=""},_a=async()=>{if(Ze.name.trim())try{let e;Me.value?(e=await q.updateQuestionBank(Me.value.id,Ze),200===e.code?(r.success("题库更新成功"),Je.value=!1,Me.value=null,Ze.name="",Ze.description="",sa()):r.error(e.message||"更新题库失败")):(e=await q.createQuestionBank(Ze),200===e.code?(r.success("创建题库成功"),Je.value=!1,Ze.name="",Ze.description="",sa()):r.error(e.message||"创建题库失败"))}catch(e){r.error("保存题库失败: "+e.message)}else r.error("请输入题库名称")},ba=()=>{Oe.value=!1,Fe.value=null,ea.name="",ea.description=""},ka=async()=>{if(ea.name.trim())try{let e;if(Fe.value)e=await I.updateSubject(Fe.value.id,ea),200===e.code?(r.success("科目更新成功"),Oe.value=!1,Fe.value=null,ea.name="",ea.description="",na()):r.error(e.message||"更新科目失败");else{const a={...ea,questionBankId:Ne.value.id};e=await I.createSubject(a),200===e.code?(r.success("创建科目成功"),Oe.value=!1,ea.name="",ea.description="",na()):r.error(e.message||"创建科目失败")}}catch(e){r.error("保存科目失败: "+e.message)}else r.error("请输入科目名称")},wa=()=>{Ee.value&&(He.value={id:Ee.value.id,subject:Ee.value.subject,chapter:Ee.value.chapter||"",type:Ee.value.type,difficulty:Ee.value.difficulty||"简单",content:Ee.value.content,options:Va(Ee.value.options),answer:Ee.value.answer,analysis:Ee.value.analysis||"",images:Ca(Ee.value.images)},Pe.value=!0)},Va=e=>{if(!e)return[];try{if("string"==typeof e){const a=JSON.parse(e);if(Array.isArray(a))return a.map(e=>({content:"string"==typeof e?e:e.content||""}))}return Array.isArray(e)?e.map(e=>({content:"string"==typeof e?e:e.content||""})):[]}catch(a){return[]}},Ca=e=>{if(!e)return[];try{let a=[];if("string"==typeof e){const l=JSON.parse(e);Array.isArray(l)&&(a=l)}else Array.isArray(e)&&(a=e);return a.filter(e=>e&&"object"==typeof e&&e.path&&"string"==typeof e.path).map(e=>({name:e.name||"image",url:xa(e.path),path:e.path}))}catch(a){return[]}},xa=e=>{if(!e||"string"!=typeof e)return"";if(e.startsWith("http"))return e;let a=e.trim();a.startsWith("/")&&(a=a.substring(1)),a.startsWith("images/")||(a=`images/${a}`);return`/uploads/${a}`},Ua=()=>{if(!Ee.value?.images)return[];try{const e="string"==typeof Ee.value.images?JSON.parse(Ee.value.images):Ee.value.images;return Array.isArray(e)?e.filter(e=>e&&"object"==typeof e&&e.path&&"string"==typeof e.path&&""!==e.path.trim()):[]}catch(e){return[]}},ja=()=>{He.value.options.length<6&&He.value.options.push({content:""})},za=async()=>{if(He.value.content.trim())if(He.value.options.length<2)r.error("至少需要2个选项");else if(He.value.answer.trim()){We.value=!0;try{let e=[];He.value.images&&Array.isArray(He.value.images)&&(e=He.value.images.filter(e=>e&&e.path&&"string"==typeof e.path&&""!==e.path.trim()).map(e=>({path:e.path})));const a={chapter:He.value.chapter,type:He.value.type,difficulty:He.value.difficulty,content:He.value.content,options:JSON.stringify(He.value.options.map(e=>e.content)),answer:He.value.answer,analysis:He.value.analysis,images:JSON.stringify(e)},l=await $.updateQuestion(He.value.id,a);200===l.code?(r.success("保存成功"),Pe.value=!1,De.value=!1,oa()):r.error(l.message||"保存失败")}catch(e){r.error("保存失败: "+e.message)}finally{We.value=!1}}else r.error("请输入正确答案");else r.error("请输入题目内容")},Aa=(e,a,l)=>{if(200===e.code){const l={name:a.name,url:e.data.url,path:e.data.path};He.value.images.push(l),r.success("图片上传成功")}else r.error(e.message||"图片上传失败")},Ba=(e,a)=>{if(He.value.images&&Array.isArray(He.value.images)){const a=He.value.images.findIndex(a=>a.name===e.name||a.path===e.path||a.url===e.url);a>-1&&He.value.images.splice(a,1)}r.success("图片删除成功")},Sa=(e,a,l)=>{r.error("图片上传失败")},qa=e=>{const a=e.type.startsWith("image/"),l=e.size/1024/1024<2;return a?!!l||(r.error("图片大小不能超过 2MB!"),!1):(r.error("只能上传图片文件!"),!1)},Ia=()=>{Le.value={chapter:"",type:"单选题",difficulty:"中等",content:"",options:[{key:"A",content:""},{key:"B",content:""}],answer:"",analysis:"",images:[]},Te.value=!0},$a=()=>{Te.value=!1,Le.value={chapter:"",type:"单选题",difficulty:"中等",content:"",options:[{key:"A",content:""},{key:"B",content:""}],answer:"",analysis:"",images:[]}},Na=()=>{if(Le.value.options.length<6){const e=String.fromCharCode(65+Le.value.options.length);Le.value.options.push({key:e,content:""})}},Qa=async()=>{if(Re.value){try{await Re.value.validate()}catch(e){return void r.error("请完善必填信息")}if(Le.value.content.trim())if(("单选题"===Le.value.type||"多选题"===Le.value.type)&&Le.value.options.length<2)r.error("至少需要2个选项");else if(Le.value.answer.trim()){Ge.value=!0;try{const e={questionBankId:Ne.value.id,subjectId:Qe.value.id,chapter:Le.value.chapter,type:Le.value.type,difficulty:Le.value.difficulty,content:Le.value.content,answer:Le.value.answer,analysis:Le.value.analysis,options:"单选题"===Le.value.type||"多选题"===Le.value.type?JSON.stringify(Le.value.options):null,images:Le.value.images.length>0?JSON.stringify(Le.value.images):null},a=await $.addQuestion(e);200===a.code?(r.success("题目创建成功"),Te.value=!1,oa()):r.error(a.message||"创建失败")}catch(e){r.error("创建题目失败: "+e.message)}finally{Ge.value=!1}}else r.error("请输入正确答案");else r.error("请输入题目内容")}},Ja=(e,a,l)=>{200===e.code?(Le.value.images.push({name:e.data.fileName,path:e.data.path,url:xa(e.data.path)}),r.success("图片上传成功")):r.error(e.message||"图片上传失败")},Oa=(e,a,l)=>{r.error("图片上传失败")},Ta=(e,a)=>{const l=Le.value.images.findIndex(a=>a.name===e.name);l>-1&&Le.value.images.splice(l,1)};return t(()=>{sa()}),(e,a)=>{const l=i("el-icon"),t=i("el-button"),Va=i("el-input"),Ca=i("el-col"),Da=i("el-row"),Ea=i("el-card"),Pa=i("el-pagination"),Wa=i("el-table-column"),Ga=i("el-tag"),Ma=i("el-table"),Fa=i("el-form-item"),Ha=i("el-form"),La=i("el-dialog"),Ra=i("el-option"),Ka=i("el-select"),Xa=i("el-upload"),Ya=i("el-descriptions-item"),Za=i("el-descriptions"),el=i("el-image"),al=i("el-radio"),ll=i("el-radio-group"),tl=d("loading");return s(),u("div",N,[Ne.value?Qe.value?(s(),u("div",re,[n(Ea,null,{header:o(()=>[c("div",de,[c("div",ce,[n(t,{onClick:ga,type:"text"},{default:o(()=>[n(l,null,{default:o(()=>[n(m(U))]),_:1}),a[46]||(a[46]=f(" 返回科目列表 ",-1))]),_:1}),c("span",pe,_(Qe.value.name),1)]),c("div",me,[$e.value.length>0?(s(),h(t,{key:0,type:"danger",onClick:ma,disabled:0===$e.value.length},{default:o(()=>[n(l,null,{default:o(()=>[n(m(A))]),_:1}),f(" 批量删除 ("+_($e.value.length)+") ",1)]),_:1},8,["disabled"])):z("",!0),n(t,{type:"success",onClick:Ia},{default:o(()=>[n(l,null,{default:o(()=>[n(m(C))]),_:1}),a[47]||(a[47]=f(" 添加题目 ",-1))]),_:1}),n(t,{type:"primary",onClick:a[5]||(a[5]=a=>e.$router.push("/smart-question-import"))},{default:o(()=>[n(l,null,{default:o(()=>[n(m(B))]),_:1}),a[48]||(a[48]=f(" 智能上传 ",-1))]),_:1}),n(t,{onClick:oa},{default:o(()=>[n(l,null,{default:o(()=>[n(m(x))]),_:1}),a[49]||(a[49]=f(" 刷新 ",-1))]),_:1})])])]),default:o(()=>[j((s(),h(Ma,{data:Ie.value,onSelectionChange:pa},{default:o(()=>[n(Wa,{type:"selection",width:"55"}),n(Wa,{prop:"id",label:"ID",width:"80"}),n(Wa,{prop:"content",label:"题目内容","min-width":"300","show-overflow-tooltip":""}),n(Wa,{prop:"type",label:"类型",width:"100"},{default:o(({row:e})=>[n(Ga,{type:ta(e.type)},{default:o(()=>[f(_(e.type),1)]),_:2},1032,["type"])]),_:1}),n(Wa,{prop:"difficulty",label:"难度",width:"100"},{default:o(({row:e})=>[n(Ga,{type:ua(e.difficulty)},{default:o(()=>[f(_(e.difficulty),1)]),_:2},1032,["type"])]),_:1}),n(Wa,{prop:"createdAt",label:"创建时间",width:"180"},{default:o(({row:e})=>[f(_(la(e.createdAt)),1)]),_:1}),n(Wa,{label:"操作",width:"150",fixed:"right"},{default:o(({row:e})=>[n(t,{size:"small",onClick:a=>{return l=e,Ee.value=l,De.value=!0,void wa();var l}},{default:o(()=>[...a[50]||(a[50]=[f("编辑",-1)])]),_:1},8,["onClick"]),n(t,{size:"small",type:"danger",onClick:a=>(async e=>{try{await S.confirm(`确定要删除题目"${e.content.substring(0,50)}..."吗？`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=await $.deleteQuestion(e.id);200===a.code?(r.success("删除成功"),oa()):r.error(a.message||"删除失败")}catch(a){"cancel"!==a&&r.error("删除失败: "+a.message)}})(e)},{default:o(()=>[...a[51]||(a[51]=[f("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[tl,Be.value]]),c("div",ve,[n(Pa,{"current-page":aa.page,"onUpdate:currentPage":a[6]||(a[6]=e=>aa.page=e),"page-size":aa.limit,"onUpdate:pageSize":a[7]||(a[7]=e=>aa.limit=e),"page-sizes":[10,20,50,100],total:aa.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:da,onCurrentChange:ca},null,8,["current-page","page-size","total"])])]),_:1})])):(s(),u("div",K,[n(Ea,null,{header:o(()=>[c("div",X,[c("div",Y,[n(t,{onClick:fa,type:"text"},{default:o(()=>[n(l,null,{default:o(()=>[n(m(U))]),_:1}),a[40]||(a[40]=f(" 返回题库列表 ",-1))]),_:1}),c("span",Z,_(Ne.value.name),1)]),c("div",ee,[n(t,{type:"primary",onClick:a[4]||(a[4]=e=>Oe.value=!0)},{default:o(()=>[n(l,null,{default:o(()=>[n(m(C))]),_:1}),a[41]||(a[41]=f(" 创建科目 ",-1))]),_:1}),n(t,{onClick:na},{default:o(()=>[n(l,null,{default:o(()=>[n(m(x))]),_:1}),a[42]||(a[42]=f(" 刷新 ",-1))]),_:1})])])]),default:o(()=>[c("div",ae,[(s(!0),u(y,null,g(qe.value,e=>(s(),h(Ea,{key:e.id,class:"subject-card",shadow:"hover",onClick:a=>ya(e)},{default:o(()=>[c("div",le,[c("h3",te,_(e.name),1),c("p",ue,_(e.description||"暂无描述"),1),c("div",se,[c("span",ne,[n(l,null,{default:o(()=>[n(m(k))]),_:1}),f(" "+_(e.questionCount||0)+" 道题目 ",1)]),c("span",oe,[n(l,null,{default:o(()=>[n(m(w))]),_:1}),f(" "+_(la(e.createdAt)),1)])])]),c("div",ie,[n(t,{size:"small",type:"primary",onClick:V(a=>ya(e),["stop"])},{default:o(()=>[...a[43]||(a[43]=[f(" 进入科目 ",-1)])]),_:1},8,["onClick"]),n(t,{size:"small",onClick:V(a=>(e=>{Fe.value=e,ea.name=e.name,ea.description=e.description||"",Oe.value=!0})(e),["stop"])},{default:o(()=>[...a[44]||(a[44]=[f(" 编辑 ",-1)])]),_:1},8,["onClick"]),n(t,{size:"small",type:"danger",onClick:V(a=>(async e=>{try{await S.confirm(`确定要删除科目"${e.name}"吗？这将删除该科目下的所有题目。`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=await I.deleteSubject(e.id);200===a.code?(r.success("删除科目成功"),na()):r.error(a.message||"删除失败")}catch(a){"cancel"!==a&&r.error("删除失败: "+a.message)}})(e),["stop"])},{default:o(()=>[...a[45]||(a[45]=[f(" 删除 ",-1)])]),_:1},8,["onClick"])])]),_:2},1032,["onClick"]))),128))])]),_:1})])):(s(),u("div",Q,[n(Ea,null,{header:o(()=>[c("div",J,[a[34]||(a[34]=c("span",null,"题库管理",-1)),c("div",O,[n(t,{type:"primary",onClick:a[0]||(a[0]=e=>Je.value=!0)},{default:o(()=>[n(l,null,{default:o(()=>[n(m(C))]),_:1}),a[32]||(a[32]=f(" 创建题库 ",-1))]),_:1}),n(t,{onClick:sa},{default:o(()=>[n(l,null,{default:o(()=>[n(m(x))]),_:1}),a[33]||(a[33]=f(" 刷新 ",-1))]),_:1})])])]),default:o(()=>[c("div",T,[n(Da,{gutter:20},{default:o(()=>[n(Ca,{span:6},{default:o(()=>[n(Va,{modelValue:Ye.keyword,"onUpdate:modelValue":a[1]||(a[1]=e=>Ye.keyword=e),placeholder:"搜索题库名称",clearable:"",onKeyup:p(ia,["enter"])},{prefix:o(()=>[n(l,null,{default:o(()=>[n(m(v))]),_:1})]),_:1},8,["modelValue"])]),_:1}),n(Ca,{span:4},{default:o(()=>[n(t,{type:"primary",onClick:ia},{default:o(()=>[n(l,null,{default:o(()=>[n(m(v))]),_:1}),a[35]||(a[35]=f(" 搜索 ",-1))]),_:1}),n(t,{onClick:ra},{default:o(()=>[...a[36]||(a[36]=[f("重置",-1)])]),_:1})]),_:1})]),_:1})]),c("div",D,[(s(!0),u(y,null,g(Se.value,e=>(s(),h(Ea,{key:e.id,class:"bank-card",shadow:"hover",onClick:a=>va(e)},{default:o(()=>[c("div",E,[c("h3",P,_(e.name),1),c("p",W,_(e.description||"暂无描述"),1),c("div",G,[c("span",M,[n(l,null,{default:o(()=>[n(m(b))]),_:1}),f(" "+_(e.subjectCount||0)+" 个科目 ",1)]),c("span",F,[n(l,null,{default:o(()=>[n(m(k))]),_:1}),f(" "+_(e.questionCount||0)+" 道题目 ",1)]),c("span",H,[n(l,null,{default:o(()=>[n(m(w))]),_:1}),f(" "+_(la(e.createdAt)),1)])])]),c("div",L,[n(t,{size:"small",type:"primary",onClick:V(a=>va(e),["stop"])},{default:o(()=>[...a[37]||(a[37]=[f(" 进入题库 ",-1)])]),_:1},8,["onClick"]),n(t,{size:"small",onClick:V(a=>(e=>{Me.value=e,Ze.name=e.name,Ze.description=e.description||"",Je.value=!0})(e),["stop"])},{default:o(()=>[...a[38]||(a[38]=[f(" 编辑 ",-1)])]),_:1},8,["onClick"]),n(t,{size:"small",type:"danger",onClick:V(a=>(async e=>{try{await S.confirm(`确定要删除题库"${e.name}"吗？这将删除该题库下的所有科目和题目。`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=await q.deleteQuestionBank(e.id);200===a.code?(r.success("删除题库成功"),sa()):r.error(a.message||"删除失败")}catch(a){"cancel"!==a&&r.error("删除失败: "+a.message)}})(e),["stop"])},{default:o(()=>[...a[39]||(a[39]=[f(" 删除 ",-1)])]),_:1},8,["onClick"])])]),_:2},1032,["onClick"]))),128))]),c("div",R,[n(Pa,{"current-page":aa.page,"onUpdate:currentPage":a[2]||(a[2]=e=>aa.page=e),"page-size":aa.limit,"onUpdate:pageSize":a[3]||(a[3]=e=>aa.limit=e),"page-sizes":[10,20,50,100],total:aa.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:da,onCurrentChange:ca},null,8,["current-page","page-size","total"])])]),_:1})])),n(La,{modelValue:Je.value,"onUpdate:modelValue":a[10]||(a[10]=e=>Je.value=e),title:Me.value?"编辑题库":"创建题库",width:"500px"},{footer:o(()=>[n(t,{onClick:ha},{default:o(()=>[...a[52]||(a[52]=[f("取消",-1)])]),_:1}),n(t,{type:"primary",onClick:_a},{default:o(()=>[...a[53]||(a[53]=[f("确定",-1)])]),_:1})]),default:o(()=>[n(Ha,{model:Ze,"label-width":"100px"},{default:o(()=>[n(Fa,{label:"题库名称",required:""},{default:o(()=>[n(Va,{modelValue:Ze.name,"onUpdate:modelValue":a[8]||(a[8]=e=>Ze.name=e),placeholder:"请输入题库名称"},null,8,["modelValue"])]),_:1}),n(Fa,{label:"题库描述"},{default:o(()=>[n(Va,{modelValue:Ze.description,"onUpdate:modelValue":a[9]||(a[9]=e=>Ze.description=e),type:"textarea",rows:3,placeholder:"请输入题库描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),n(La,{modelValue:Oe.value,"onUpdate:modelValue":a[13]||(a[13]=e=>Oe.value=e),title:Fe.value?"编辑科目":"创建科目",width:"500px"},{footer:o(()=>[n(t,{onClick:ba},{default:o(()=>[...a[54]||(a[54]=[f("取消",-1)])]),_:1}),n(t,{type:"primary",onClick:ka},{default:o(()=>[...a[55]||(a[55]=[f("确定",-1)])]),_:1})]),default:o(()=>[n(Ha,{model:ea,"label-width":"100px"},{default:o(()=>[n(Fa,{label:"科目名称",required:""},{default:o(()=>[n(Va,{modelValue:ea.name,"onUpdate:modelValue":a[11]||(a[11]=e=>ea.name=e),placeholder:"请输入科目名称"},null,8,["modelValue"])]),_:1}),n(Fa,{label:"科目描述"},{default:o(()=>[n(Va,{modelValue:ea.description,"onUpdate:modelValue":a[12]||(a[12]=e=>ea.description=e),type:"textarea",rows:3,placeholder:"请输入科目描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),n(La,{modelValue:De.value,"onUpdate:modelValue":a[23]||(a[23]=e=>De.value=e),title:Pe.value?"编辑题目":"题目详情",width:"900px","close-on-click-modal":!1},{footer:o(()=>[c("div",je,[n(t,{onClick:a[22]||(a[22]=e=>De.value=!1)},{default:o(()=>[...a[64]||(a[64]=[f("取消",-1)])]),_:1}),Pe.value?(s(),h(t,{key:0,type:"primary",loading:We.value,onClick:za},{default:o(()=>[...a[65]||(a[65]=[f(" 保存 ",-1)])]),_:1},8,["loading"])):(s(),h(t,{key:1,type:"primary",onClick:wa},{default:o(()=>[...a[66]||(a[66]=[f("编辑",-1)])]),_:1}))])]),default:o(()=>[Ee.value?(s(),u("div",fe,[Pe.value?(s(),u("div",ye,[n(Ha,{model:He.value,"label-width":"100px","label-position":"left"},{default:o(()=>[n(Da,{gutter:20},{default:o(()=>[n(Ca,{span:12},{default:o(()=>[n(Fa,{label:"题目ID"},{default:o(()=>[n(Va,{modelValue:He.value.id,"onUpdate:modelValue":a[14]||(a[14]=e=>He.value.id=e),disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),n(Ca,{span:12},{default:o(()=>[n(Fa,{label:"科目"},{default:o(()=>[n(Va,{modelValue:He.value.subject,"onUpdate:modelValue":a[15]||(a[15]=e=>He.value.subject=e),disabled:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(Da,{gutter:20},{default:o(()=>[n(Ca,{span:12},{default:o(()=>[n(Fa,{label:"章节"},{default:o(()=>[n(Va,{modelValue:He.value.chapter,"onUpdate:modelValue":a[16]||(a[16]=e=>He.value.chapter=e)},null,8,["modelValue"])]),_:1})]),_:1}),n(Ca,{span:12},{default:o(()=>[n(Fa,{label:"类型"},{default:o(()=>[n(Ka,{modelValue:He.value.type,"onUpdate:modelValue":a[17]||(a[17]=e=>He.value.type=e),style:{width:"100%"}},{default:o(()=>[n(Ra,{label:"单选题",value:"单选题"}),n(Ra,{label:"多选题",value:"多选题"}),n(Ra,{label:"判断题",value:"判断题"}),n(Ra,{label:"填空题",value:"填空题"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(Da,{gutter:20},{default:o(()=>[n(Ca,{span:12},{default:o(()=>[n(Fa,{label:"难度"},{default:o(()=>[n(Ka,{modelValue:He.value.difficulty,"onUpdate:modelValue":a[18]||(a[18]=e=>He.value.difficulty=e),style:{width:"100%"}},{default:o(()=>[n(Ra,{label:"简单",value:"简单"}),n(Ra,{label:"中等",value:"中等"}),n(Ra,{label:"困难",value:"困难"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),n(Ca,{span:12},{default:o(()=>[n(Fa,{label:"正确答案"},{default:o(()=>[n(Va,{modelValue:He.value.answer,"onUpdate:modelValue":a[19]||(a[19]=e=>He.value.answer=e),placeholder:"如：A、AB、正确等"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(Fa,{label:"题目内容"},{default:o(()=>[n(Va,{modelValue:He.value.content,"onUpdate:modelValue":a[20]||(a[20]=e=>He.value.content=e),type:"textarea",rows:4,placeholder:"请输入题目内容"},null,8,["modelValue"])]),_:1}),n(Fa,{label:"选项"},{default:o(()=>[c("div",ge,[(s(!0),u(y,null,g(He.value.options,(e,l)=>(s(),u("div",{key:l,class:"option-item"},[n(Va,{modelValue:He.value.options[l].content,"onUpdate:modelValue":e=>He.value.options[l].content=e,placeholder:`选项 ${String.fromCharCode(65+l)}`},{prepend:o(()=>[f(_(String.fromCharCode(65+l))+".",1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"]),He.value.options.length>2?(s(),h(t,{key:0,type:"danger",size:"small",onClick:e=>(e=>{He.value.options.length>2&&He.value.options.splice(e,1)})(l)},{default:o(()=>[...a[56]||(a[56]=[f(" 删除 ",-1)])]),_:1},8,["onClick"])):z("",!0)]))),128)),He.value.options.length<6?(s(),h(t,{key:0,type:"primary",size:"small",onClick:ja},{default:o(()=>[...a[57]||(a[57]=[f(" 添加选项 ",-1)])]),_:1})):z("",!0)])]),_:1}),n(Fa,{label:"解析"},{default:o(()=>[n(Va,{modelValue:He.value.analysis,"onUpdate:modelValue":a[21]||(a[21]=e=>He.value.analysis=e),type:"textarea",rows:3,placeholder:"请输入题目解析"},null,8,["modelValue"])]),_:1}),n(Fa,{label:"解析图片"},{default:o(()=>[c("div",he,[n(Xa,{ref:"imageUploadRef",action:Ke.value,headers:Xe.value,"on-success":Aa,"on-error":Sa,"on-remove":Ba,"before-upload":qa,"file-list":He.value.images,"list-type":"picture-card",limit:5,accept:"image/*"},{default:o(()=>[n(l,null,{default:o(()=>[n(m(C))]),_:1})]),_:1},8,["action","headers","file-list"]),a[58]||(a[58]=c("div",{class:"upload-tip"}," 支持上传JPG、PNG格式图片，最多5张 ",-1))])]),_:1})]),_:1},8,["model"])])):(s(),u("div",_e,[n(Za,{column:2,border:""},{default:o(()=>[n(Ya,{label:"题目ID"},{default:o(()=>[f(_(Ee.value.id),1)]),_:1}),n(Ya,{label:"科目"},{default:o(()=>[f(_(Ee.value.subject),1)]),_:1}),n(Ya,{label:"章节"},{default:o(()=>[f(_(Ee.value.chapter),1)]),_:1}),n(Ya,{label:"类型"},{default:o(()=>[n(Ga,{type:ta(Ee.value.type)},{default:o(()=>{return[f(_((e=Ee.value.type,{"单选题":"单选题","多选题":"多选题","判断题":"判断题","填空题":"填空题"}[e]||e)),1)];var e}),_:1},8,["type"])]),_:1}),n(Ya,{label:"难度"},{default:o(()=>[n(Ga,{type:ua(Ee.value.difficulty)},{default:o(()=>[f(_(Ee.value.difficulty),1)]),_:1},8,["type"])]),_:1}),n(Ya,{label:"创建时间"},{default:o(()=>[f(_(la(Ee.value.createdAt)),1)]),_:1})]),_:1}),c("div",be,[a[63]||(a[63]=c("h4",null,"题目内容：",-1)),c("p",null,_(Ee.value.content),1),Ee.value.options&&Ee.value.options.length>0?(s(),u("div",ke,[a[59]||(a[59]=c("h4",null,"选项：",-1)),c("ul",null,[(s(!0),u(y,null,g(Ee.value.options,(e,a)=>(s(),u("li",{key:a},_(String.fromCharCode(65+a))+". "+_(e.content||e),1))),128))])])):z("",!0),c("div",we,[a[60]||(a[60]=c("h4",null,"正确答案：",-1)),c("p",Ve,_(Ee.value.answer),1)]),Ee.value.analysis?(s(),u("div",Ce,[a[61]||(a[61]=c("h4",null,"解析：",-1)),c("p",null,_(Ee.value.analysis),1)])):z("",!0),Ee.value.images&&Ee.value.images.length>0?(s(),u("div",xe,[a[62]||(a[62]=c("h4",null,"解析图片：",-1)),c("div",Ue,[(s(!0),u(y,null,g(Ua(),(e,a)=>(s(),h(el,{key:a,src:xa(e.path),"preview-src-list":Ua().map(e=>xa(e.path)),fit:"cover",class:"analysis-image"},null,8,["src","preview-src-list"]))),128))])])):z("",!0)])]))])):z("",!0)]),_:1},8,["modelValue","title"]),n(La,{modelValue:Te.value,"onUpdate:modelValue":a[31]||(a[31]=e=>Te.value=e),title:"创建题目",width:"800px","close-on-click-modal":!1},{footer:o(()=>[c("div",Ae,[n(t,{onClick:$a},{default:o(()=>[...a[71]||(a[71]=[f("取消",-1)])]),_:1}),n(t,{type:"primary",loading:Ge.value,onClick:Qa},{default:o(()=>[...a[72]||(a[72]=[f(" 创建 ",-1)])]),_:1},8,["loading"])])]),default:o(()=>[n(Ha,{model:Le.value,"label-width":"100px",ref_key:"createFormRef",ref:Re},{default:o(()=>[n(Fa,{label:"题目内容",prop:"content",rules:[{required:!0,message:"请输入题目内容",trigger:"blur"}]},{default:o(()=>[n(Va,{modelValue:Le.value.content,"onUpdate:modelValue":a[24]||(a[24]=e=>Le.value.content=e),type:"textarea",rows:3,placeholder:"请输入题目内容"},null,8,["modelValue"])]),_:1}),n(Fa,{label:"题目类型",prop:"type",rules:[{required:!0,message:"请选择题目类型",trigger:"change"}]},{default:o(()=>[n(Ka,{modelValue:Le.value.type,"onUpdate:modelValue":a[25]||(a[25]=e=>Le.value.type=e),placeholder:"请选择题目类型",style:{width:"100%"}},{default:o(()=>[n(Ra,{label:"单选题",value:"单选题"}),n(Ra,{label:"多选题",value:"多选题"}),n(Ra,{label:"判断题",value:"判断题"}),n(Ra,{label:"填空题",value:"填空题"})]),_:1},8,["modelValue"])]),_:1}),n(Fa,{label:"难度等级",prop:"difficulty"},{default:o(()=>[n(Ka,{modelValue:Le.value.difficulty,"onUpdate:modelValue":a[26]||(a[26]=e=>Le.value.difficulty=e),placeholder:"请选择难度等级",style:{width:"100%"}},{default:o(()=>[n(Ra,{label:"简单",value:"简单"}),n(Ra,{label:"中等",value:"中等"}),n(Ra,{label:"困难",value:"困难"})]),_:1},8,["modelValue"])]),_:1}),n(Fa,{label:"章节",prop:"chapter"},{default:o(()=>[n(Va,{modelValue:Le.value.chapter,"onUpdate:modelValue":a[27]||(a[27]=e=>Le.value.chapter=e),placeholder:"请输入章节名称"},null,8,["modelValue"])]),_:1}),"单选题"===Le.value.type||"多选题"===Le.value.type?(s(),h(Fa,{key:0,label:"选项配置"},{default:o(()=>[c("div",ze,[(s(!0),u(y,null,g(Le.value.options,(e,l)=>(s(),u("div",{key:l,class:"option-item"},[n(Va,{modelValue:e.key,"onUpdate:modelValue":a=>e.key=a,placeholder:"选项标识",style:{width:"80px","margin-right":"10px"},disabled:""},null,8,["modelValue","onUpdate:modelValue"]),n(Va,{modelValue:e.content,"onUpdate:modelValue":a=>e.content=a,placeholder:"选项内容",style:{flex:"1","margin-right":"10px"}},null,8,["modelValue","onUpdate:modelValue"]),Le.value.options.length>2?(s(),h(t,{key:0,type:"danger",size:"small",onClick:e=>(e=>{Le.value.options.length>2&&(Le.value.options.splice(e,1),Le.value.options.forEach((e,a)=>{e.key=String.fromCharCode(65+a)}))})(l)},{default:o(()=>[...a[67]||(a[67]=[f(" 删除 ",-1)])]),_:1},8,["onClick"])):z("",!0)]))),128)),Le.value.options.length<6?(s(),h(t,{key:0,type:"primary",size:"small",onClick:Na},{default:o(()=>[...a[68]||(a[68]=[f(" 添加选项 ",-1)])]),_:1})):z("",!0)])]),_:1})):z("",!0),"判断题"===Le.value.type?(s(),h(Fa,{key:1,label:"选项"},{default:o(()=>[n(ll,{modelValue:Le.value.answer,"onUpdate:modelValue":a[28]||(a[28]=e=>Le.value.answer=e)},{default:o(()=>[n(al,{label:"正确"},{default:o(()=>[...a[69]||(a[69]=[f("正确",-1)])]),_:1}),n(al,{label:"错误"},{default:o(()=>[...a[70]||(a[70]=[f("错误",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})):z("",!0),n(Fa,{label:"正确答案",prop:"answer",rules:[{required:!0,message:"请输入正确答案",trigger:"blur"}]},{default:o(()=>["判断题"!==Le.value.type?(s(),h(Va,{key:0,modelValue:Le.value.answer,"onUpdate:modelValue":a[29]||(a[29]=e=>Le.value.answer=e),placeholder:"请输入正确答案，如：A、AB、正确等"},null,8,["modelValue"])):z("",!0)]),_:1}),n(Fa,{label:"解析",prop:"analysis"},{default:o(()=>[n(Va,{modelValue:Le.value.analysis,"onUpdate:modelValue":a[30]||(a[30]=e=>Le.value.analysis=e),type:"textarea",rows:3,placeholder:"请输入题目解析"},null,8,["modelValue"])]),_:1}),n(Fa,{label:"解析图片"},{default:o(()=>[n(Xa,{action:"/api/upload/image",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`},"on-success":Ja,"on-error":Oa,"before-upload":qa,"file-list":Le.value.images,"list-type":"picture-card",limit:5,"on-remove":Ta},{default:o(()=>[n(l,null,{default:o(()=>[n(m(C))]),_:1})]),_:1},8,["action","headers","file-list"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-b20b43fd"]]);export{Be as default};
