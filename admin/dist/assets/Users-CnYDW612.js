import{_ as e,r as a,a as t,h as l,c as s,o as i,d as n,w as o,f as d,E as r,k as u,b as c,j as p,p as m,q as g,s as f,g as h,v as w,l as _,t as y,x as b}from"./index-CgU9ouN3.js";const v=async(e,a={})=>{const t=localStorage.getItem("token");try{const l=await fetch(`https://practice.insightdata.top:8443${e}`,{method:a.method||"GET",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest",...t&&{Authorization:`Bearer ${t}`},...a.headers},credentials:"include",...a});if(!l.ok){const e=await l.json().catch(()=>({}));throw new Error(e.message||`HTTP ${l.status}: ${l.statusText}`)}const s=await l.json();if(s.code&&200!==s.code)throw new Error(s.message||"请求失败");return s}catch(l){throw l}};const k={class:"users-page"},C={class:"card-header"},z={class:"search-section"},A={class:"pagination"},V=e({__name:"Users",setup(e){const V=a(!1),T=a([]),j=t({keyword:"",status:"",isAdmin:""}),x=t({page:1,limit:10,total:0}),U=async()=>{V.value=!0;try{const e={page:x.page,limit:x.limit,...j},a=await function(e){const a=new URLSearchParams(e).toString();return v(`/api/user/list?${a}`)}(e);T.value=a.data.users,x.total=a.data.pagination.total}catch(e){r.error("获取用户列表失败: "+e.message)}finally{V.value=!1}},L=()=>{x.page=1,U()},S=()=>{Object.assign(j,{keyword:"",status:"",isAdmin:""}),L()},$=e=>{x.limit=e,x.page=1,U()},E=e=>{x.page=e,U()},q=()=>{r.info("添加用户功能开发中...")},I=e=>e?new Date(e).toLocaleString("zh-CN"):"";return l(()=>{U()}),(e,a)=>{const t=d("el-icon"),l=d("el-button"),v=d("el-input"),U=d("el-col"),N=d("el-option"),P=d("el-select"),R=d("el-row"),D=d("el-table-column"),H=d("el-tag"),X=d("el-table"),B=d("el-pagination"),G=d("el-card"),K=u("loading");return i(),s("div",k,[n(G,null,{header:o(()=>[c("div",C,[a[6]||(a[6]=c("span",null,"用户管理",-1)),n(l,{type:"primary",onClick:q},{default:o(()=>[n(t,null,{default:o(()=>[n(g(b))]),_:1}),a[5]||(a[5]=h(" 添加用户 ",-1))]),_:1})])]),default:o(()=>[c("div",z,[n(R,{gutter:20},{default:o(()=>[n(U,{span:6},{default:o(()=>[n(v,{modelValue:j.keyword,"onUpdate:modelValue":a[0]||(a[0]=e=>j.keyword=e),placeholder:"搜索用户名、手机号或邮箱",clearable:"",onClear:L,onKeyup:m(L,["enter"])},{prefix:o(()=>[n(t,null,{default:o(()=>[n(g(f))]),_:1})]),_:1},8,["modelValue"])]),_:1}),n(U,{span:4},{default:o(()=>[n(P,{modelValue:j.status,"onUpdate:modelValue":a[1]||(a[1]=e=>j.status=e),placeholder:"用户状态",clearable:"",onChange:L},{default:o(()=>[n(N,{label:"全部",value:""}),n(N,{label:"正常",value:"active"}),n(N,{label:"禁用",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),n(U,{span:4},{default:o(()=>[n(P,{modelValue:j.isAdmin,"onUpdate:modelValue":a[2]||(a[2]=e=>j.isAdmin=e),placeholder:"用户类型",clearable:"",onChange:L},{default:o(()=>[n(N,{label:"全部",value:""}),n(N,{label:"管理员",value:"true"}),n(N,{label:"普通用户",value:"false"})]),_:1},8,["modelValue"])]),_:1}),n(U,{span:4},{default:o(()=>[n(l,{type:"primary",onClick:L},{default:o(()=>[n(t,null,{default:o(()=>[n(g(f))]),_:1}),a[7]||(a[7]=h(" 搜索 ",-1))]),_:1}),n(l,{onClick:S},{default:o(()=>[n(t,null,{default:o(()=>[n(g(w))]),_:1}),a[8]||(a[8]=h(" 重置 ",-1))]),_:1})]),_:1})]),_:1})]),p((i(),_(X,{data:T.value,stripe:"",style:{width:"100%"}},{default:o(()=>[n(D,{prop:"id",label:"ID",width:"80"}),n(D,{prop:"nickName",label:"用户名","min-width":"120"}),n(D,{prop:"phoneNumber",label:"手机号",width:"130"}),n(D,{prop:"email",label:"邮箱","min-width":"180"}),n(D,{label:"用户类型",width:"100"},{default:o(({row:e})=>[n(H,{type:e.isAdmin?"danger":"success"},{default:o(()=>[h(y(e.isAdmin?"管理员":"普通用户"),1)]),_:2},1032,["type"])]),_:1}),n(D,{label:"状态",width:"100"},{default:o(({row:e})=>[n(H,{type:"active"===e.status?"success":"danger"},{default:o(()=>[h(y("active"===e.status?"正常":"禁用"),1)]),_:2},1032,["type"])]),_:1}),n(D,{prop:"lastLoginTime",label:"最后登录",width:"160"},{default:o(({row:e})=>[h(y(e.lastLoginTime?I(e.lastLoginTime):"从未登录"),1)]),_:1}),n(D,{prop:"createdAt",label:"创建时间",width:"160"},{default:o(({row:e})=>[h(y(I(e.createdAt)),1)]),_:1}),n(D,{label:"操作",width:"200",fixed:"right"},{default:o(({row:e})=>[n(l,{size:"small",onClick:e=>{r.info("编辑用户功能开发中...")}},{default:o(()=>[...a[9]||(a[9]=[h("编辑",-1)])]),_:1},8,["onClick"]),n(l,{size:"small",type:"warning",onClick:e=>{r.info("重置密码功能开发中...")}},{default:o(()=>[...a[10]||(a[10]=[h("重置密码",-1)])]),_:1},8,["onClick"]),n(l,{size:"small",type:"active"===e.status?"danger":"success",onClick:e=>{r.info("切换用户状态功能开发中...")}},{default:o(()=>[h(y("active"===e.status?"禁用":"启用"),1)]),_:2},1032,["type","onClick"]),n(l,{size:"small",type:"danger",onClick:e=>{r.info("删除用户功能开发中...")}},{default:o(()=>[...a[11]||(a[11]=[h("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[K,V.value]]),c("div",A,[n(B,{"current-page":x.page,"onUpdate:currentPage":a[3]||(a[3]=e=>x.page=e),"page-size":x.limit,"onUpdate:pageSize":a[4]||(a[4]=e=>x.limit=e),"page-sizes":[10,20,50,100],total:x.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:$,onCurrentChange:E},null,8,["current-page","page-size","total"])])]),_:1})])}}},[["__scopeId","data-v-94128df1"]]);export{V as default};
